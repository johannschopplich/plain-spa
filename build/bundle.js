let e=location,t=Symbol(),n=Symbol(),r=Symbol(),o=Symbol("route");function l(e,t){let n=e.replace(/(^\/|\/$)/g,"");for(let[r,[o]]of t.entries()){if("string"==typeof o){let t=o.replace(/(^\/|\/$)/g,"");if(t===n)return[e,r];if(t.includes("*")){let o=t.replace(/[\s!#$()+,.:<=?[\\\]^{|}]/g,"\\$&").replace(/\*/g,"([^/]*)"),l=RegExp("^"+o+"$","i"),s=n.match(l);if(s)return[e,r,s.slice(1)]}}if(o instanceof RegExp){let t=n.match(o);if(t)return[e,r,t.slice(1)]}}return[e]}const s=[];let i;function a(e){function t(n){if(0===arguments.length)return i&&!t._observers.has(i)&&(t._observers.add(i),i._observables.push(t)),e;e=n;const r=i;return i=void 0,t._runObservers=new Set(t._observers),t._runObservers.forEach(e=>e._fresh=!1),t._runObservers.forEach(e=>{e._fresh||e()}),i=r,e}return t.$o=!0,t._observers=new Set,t._pending=s,t}function c(e,t){function n(){const r=i;i&&i._children.push(n);const o=n._children;u(n),n._fresh=!0,i=n,t=e(t),o.forEach(e=>{-1===n._children.indexOf(e)&&(e._fresh=!0)});return function e(t){return t.reduce((t,n)=>t.concat(n,e(n._children)),[])}(n._children).forEach(d),i=r,t}function r(){return n._fresh?n._observables.forEach(e=>e()):t=n(),t}return e._update=n,f(n),n(),r.$o=!0,r}function d(e){e._fresh&&e._observables.forEach(t=>{t._runObservers&&t._runObservers.delete(e)})}function u(e){e._children.forEach(u),e._observables.forEach(t=>{t._observers.delete(e),t._runObservers&&t._runObservers.delete(e)}),e._cleanups.forEach(e=>e()),f(e)}function f(e){e._observables=[],e._children=[],e._cleanups=[]}const h={},p=[];function g(e){return this._listeners[e.type](e)}h.h=(...e)=>{let t;const n=r=>{if(null==r);else if("string"==typeof r)t?h.add(t,r):t=h.s?document.createElementNS("http://www.w3.org/2000/svg",r):document.createElement(r);else if(Array.isArray(r))t||(t=document.createDocumentFragment()),r.forEach(n);else if(r instanceof Node)t?h.add(t,r):t=r;else if("object"==typeof r)h.property(t,r,null,h.s);else if("function"==typeof r)if(t){const e=h.add(t,"");h.insert(t,r,e)}else t=r.apply(null,e.splice(1));else h.add(t,""+r)};return e.forEach(n),t},h.insert=(e,t,n,r,o)=>(e=n&&n.parentNode||e,o=o||r instanceof Node&&r,t===r||(r&&"string"!=typeof r||!("string"==typeof t||"number"==typeof t&&(t+=""))?"function"==typeof t?h.subscribe(()=>{r=h.insert(e,t.call({el:e,endMark:n}),n,r,o)}):(n?r&&(o||(o=r._startMark&&r._startMark.nextSibling||n.previousSibling),h.rm(e,o,n)):e.textContent="",r=null,t&&!0!==t&&(r=h.add(e,t,n))):(null!=r&&e.firstChild?n?(n.previousSibling||e.lastChild).data=t:e.firstChild.data=t:n?h.add(e,t,n):e.textContent=t,r=t)),r),h.property=(e,t,n,r,o)=>{if(null!=t)if(!n||"attrs"===n&&(r=!0))for(n in t)h.property(e,t[n],n,r,o);else"o"!==n[0]||"n"!==n[1]||t.$o?"function"==typeof t?h.subscribe(()=>{h.property(e,t.call({el:e,name:n}),n,r,o)}):o?e.style.setProperty(n,t):r||"data-"===n.slice(0,5)||"aria-"===n.slice(0,5)?e.setAttribute(n,t):"style"===n?"string"==typeof t?e.style.cssText=t:h.property(e,t,null,r,!0):("class"===n&&(n+="Name"),e[n]=t):((e,t,n)=>{t=t.slice(2).toLowerCase(),n?e.addEventListener(t,g):e.removeEventListener(t,g),(e._listeners||(e._listeners={}))[t]=n})(e,n,t)},h.add=(e,t,n)=>{const r=(e=>{const{childNodes:t}=e;if(t&&11===e.nodeType)return t.length<2?t[0]:{_startMark:h.add(e,"",t[0])}})(t=(e=>"string"==typeof e?document.createTextNode(e):e instanceof Node?e:h.h(p,e))(t))||t;return e.insertBefore(t,n&&n.parentNode&&n),r},h.rm=(e,t,n)=>{for(;t&&t!==n;){const n=t.nextSibling;e===t.parentNode&&e.removeChild(t),t=n}};function m(e,t,n){const{root:r,subscribe:o,sample:l,cleanup:s}=h;null==n&&(n=!t.$t);const i=h.h([]),a=h.add(i,""),c=new Map,d=new Map,u=new Set;function f(e,o){if(null==e)return;let l=d.get(e);return 1===o?(u.delete(e),l||(l=n?r(n=>(c.set(e,n),t(e.$v||e))):t(e.$v||e),11===l.nodeType&&(l=(e=>{const{childNodes:t}=e,{length:n}=t;if(n<2)return t[0];const r=Array.from(t);return{nodeType:111,_firstChild:r[0],_lastChild:r[n-1],_valueOf(){if(t.length!==n){let t=0;for(;t<n;)e.appendChild(r[t++])}return e}}})(l)||l),d.set(e,l))):-1===o&&u.add(e),((e,t)=>111===e.nodeType?1/t<0?t?h.rm(e._firstChild.parentNode,e._firstChild.nextSibling,e._lastChild.nextSibling)||e._firstChild:e._lastChild:t?e._valueOf():e._firstChild:e)(l,o)}function p(e){let t=c.get(e);t&&(t(),c.delete(e)),d.delete(e)}return s(o(t=>{const n=e();return l(()=>{u.clear();const e=Array.from(function(e,t,n,r,o){const l=new Map,s=new Map;let i,a;for(i=0;i<t.length;i++)l.set(t[i],i);for(i=0;i<n.length;i++)s.set(n[i],i);for(i=a=0;i!==t.length||a!==n.length;){var c=t[i],d=n[a];if(null===c)i++;else if(n.length<=a)e.removeChild(r(t[i],-1)),i++;else if(t.length<=i)e.insertBefore(r(d,1),r(t[i],0)||o),a++;else if(c===d)i++,a++;else{var u=s.get(c),f=l.get(d);void 0===u?(e.removeChild(r(t[i],-1)),i++):void 0===f?(e.insertBefore(r(d,1),r(t[i],0)||o),a++):(e.insertBefore(r(t[f],1),r(t[i],0)||o),t[f]=null,f>i+1&&i++,a++)}}return n}(a.parentNode,t||[],n,f,a));return u.forEach(p),e})})),s((function(){c.forEach(e=>e()),c.clear(),d.clear(),u.clear()})),i}h.subscribe=function(e){return c(e),()=>u(e._update)},h.cleanup=function(e){return i&&i._cleanups.push(e),e},h.root=function(e){const t=i,n=()=>{};i=n,f(n);const r=e(()=>{u(n),i=void 0});return i=t,r},h.sample=function(e){const t=i;i=void 0;const n=e();return i=t,n},h.hs=(...e)=>{const t=h.s;h.s=!0;const n=b(...e);return h.s=t,n};const b=(...e)=>h.h.apply(h.h,e),_=({name:e})=>b("h1",{class:"title text-4"},"Hello ",e),v=()=>b(_,{name:"World"}),y=()=>{const e=a(""),t=a([]),n=localStorage.getItem("app.todo");n&&t(JSON.parse(n));return b("div",null,b("h1",{class:"title text-4"},"Todo List"),b(E,{items:t}),b("form",{onsubmit:n=>{n.preventDefault(),e().length&&(t([...t(),{text:e(),id:Date.now()}]),localStorage.setItem("app.todo",JSON.stringify(t())),e(""))}},b("label",{class:"label",htmlFor:"new-todo"},"What needs to be done?"),b("input",{id:"new-todo",class:"control",onchange:t=>e(t.target.value),value:e,style:{"margin-bottom":"var(--space-xs)"}}),b("button",{class:"button is-primary is-outlined"},"Add #",()=>t().length+1)))},E=({items:e})=>b("ul",{style:{"margin-left":"var(--space-l)"}},m(e,e=>b("li",{id:e.id},e.text))),x=()=>b("h1",{class:"title text-4"},"Not Found");const S=()=>b("header",null,b("div",{class:"box","data-theme":"light"},b("p",{class:"title text-4"},"Plain SPA"),b("nav",null,b("ul",{class:"stack-h"},b("li",null,b("a",{href:"/"},"Home")),b("li",null,b("a",{href:"/todo"},"Todo")),b("li",null,b("a",{href:"/blog/post-with-id"},"Post with ID")),b("li",null,b("a",{href:"/any-link","data-ignore-router":!0},"Ignore Router Link")),b("li",null,b("a",{href:"/not-found"},"404")))))),w=(e=>{let t={},n={},r={dispatch(e,o){if("@dispatch"!==e&&r.dispatch("@dispatch",[e,o,t[e]]),t[e]){let l,s={};t[e].forEach(e=>{let t=e(n,o);t&&"function"!=typeof t.then&&(l=n={...n,...t},s={...s,...t})}),l&&r.dispatch("@changed",s)}},get:()=>n,on:(e,n)=>((t[e]||(t[e]=[])).push(n),()=>{t[e]=t[e].filter(e=>e!==n)})};return e.forEach(e=>{e&&e(r)}),r.dispatch("@init"),r})([function(s=[]){return i=>{i.on("@init",()=>{i.dispatch(t,l(e.pathname,s))}),i.on(n,()=>{}),i.on(r,(e,r)=>{e[o].path!==r&&history.pushState(null,null,r),i.dispatch(t,l(r,s)),i.dispatch(n,i.get()[o])}),i.on(t,(e,[t,n,r=[]])=>{let l=s[n],i={};return i[o]={match:!1,path:t,params:r},l&&(i[o].match=l[1](...r)),i}),document.documentElement.addEventListener("click",t=>{let n=t.target.closest("a");t.defaultPrevented||null==n||0!==n.href.indexOf(e.origin)||"_blank"===n.target||null!=n.dataset.ignoreRouter||0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||(t.preventDefault(),i.dispatch(r,n.href.slice(e.origin.length)))}),window.addEventListener("popstate",()=>{i.get()[o].path!==e.pathname&&(i.dispatch(t,l(e.pathname,s)),i.dispatch(n,i.get()[o]))})}}([["/",()=>({page:"home",component:v})],["/todo",()=>({page:"todo",component:y})],["/blog/*",e=>{return{page:"post",component:(t={id:e},b([b("h1",{class:"title text-4"},"Post"),b("p",null,JSON.stringify(t))])),id:e};var t}],["*",()=>({page:"error",component:x})]])]),C=w.get()[o];console.log(C);const N=a(C.match.component);w.on(n,(e,t)=>{console.log(t),N(t.match.component)}),document.getElementById("app").append((e=>b([b(S,null),b("main",null,b("div",{class:"box","data-theme":"light"},e))]))(N));
